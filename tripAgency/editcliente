<?php
include 'db.php';

// prendo l'id del cliente dall'URL
$id = $_GET['id'];

// prendo i dati del cliente
$query = "SELECT * FROM clienti WHERE id = $id";
$result = mysqli_query($conn, $query);
$cliente = mysqli_fetch_assoc($result);

// se il form Ã¨ stato inviato aggiorno i dati
if ($_SERVER["REQUEST_METHOD"] == "POST") {
    $nome = $_POST['nome'];
    $cognome = $_POST['cognome'];
    $email = $_POST['email'];
    $telefono = $_POST['telefono'];
    $nazione = $_POST['nazione'];
    $codice_fiscale = $_POST['codice_fiscale'];
    $documento = $_POST['documento'];

    $update = "UPDATE clienti SET 
        nome='$nome', 
        cognome='$cognome', 
        email='$email', 
        telefono='$telefono', 
        nazione='$nazione', 
        codice_fiscale='$codice_fiscale', 
        documento='$documento' 
        WHERE id=$id";

    mysqli_query($conn, $update);

    // ritorna alla pagina clienti.php 
    header("Location: clienti.php");
    
}
?>

<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <title>Modifica Cliente</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body class="bg-light">

    <div class="container mt-5">
        <h2>Modifica Cliente</h2>
        <form method="POST">
            <div class="row g-3">
                <div class="col-md-6">
                    <label class="fw-bold">Nome:</label>
                    <input type="text" name="nome" class="form-control" value="<?= $cliente['nome'] ?>">
                </div>

                <div class="col-md-6">
                    <label class="fw-bold">Cognome:</label>
                    <input type="text" name="cognome" class="form-control" value="<?= $cliente['cognome'] ?>">
                </div>

                <div class="col-md-6">
                    <label class="fw-bold">Email:</label>
                    <input type="text" name="email" class="form-control" value="<?= $cliente['email'] ?>">
                </div>

                <div class="col-md-6">
                    <label class="fw-bold">Telefono:</label>
                    <input type="text" name="telefono" class="form-control" value="<?= $cliente['telefono'] ?>">
                </div>

                <div class="col-md-6">
                    <label class="fw-bold">Nazione:</label>
                    <input type="text" name="nazione" class="form-control" value="<?= $cliente['nazione'] ?>">
                </div>

                <div class="col-md-6">
                    <label class="fw-bold">Codice Fiscale:</label>
                    <input type="text" name="codice_fiscale" class="form-control" value="<?= $cliente['codice_fiscale'] ?>">
                </div>

                <div class="col-md-6">
                    <label class="fw-bold">Documento:</label>
                    <input type="text" name="documento" class="form-control" value="<?= $cliente['documento'] ?>">
                </div>

                <div class="col-md-12 mt-3">
                    <button type="submit" class="btn btn-success">Salva Modifiche</button>
                    <a href="clienti.php" class="btn btn-secondary">Annulla</a>
                </div>
            </div>
        </form>
    </div>

</body>
</html>
